---
trigger: always_on
alwaysApply: true
---
# 问题解决标准流程

## 问题修复标准操作程序 (SOP)

### 第一步：问题分析阶段
**目标：** 找到问题的根本原因，避免治标不治本

#### 1.1 问题描述记录
- 详细记录问题现象和触发条件
- 收集错误日志和堆栈信息
- 确定问题的影响范围和严重程度

#### 1.2 根本原因分析
- 使用"5个为什么"方法深挖原因
- 绘制问题因果关系图
- 识别是设计问题还是实现问题
- 确认是否为系统性问题

#### 1.3 禁止行为
- ❌ 不能看到现象就直接修改
- ❌ 不能猜测问题原因
- ❌ 不能跳过分析直接写代码

### 第二步：解决方案设计阶段
**目标：** 制定完整的解决方案，考虑全局影响

#### 2.1 方案设计原则
- 从根本原因出发设计解决方案
- 考虑对整体架构的影响
- 评估方案的可行性和风险
- 确保方案不破坏现有功能

#### 2.2 影响分析
```
影响分析检查表：
- [ ] 对其他模块的影响
- [ ] 对接口兼容性的影响  
- [ ] 对性能的影响
- [ ] 对数据一致性的影响
- [ ] 对用户体验的影响
```

#### 2.3 方案评审
- 方案必须经过评审确认
- 复杂问题需要团队讨论
- 涉及架构变更需要架构师确认

### 第三步：实施阶段
**目标：** 按照设计方案精确实施，保证质量

#### 3.1 实施准备
- 创建功能分支进行修改
- 备份相关的原始代码
- 准备回滚预案

#### 3.2 编码规范
- 严格按照解决方案实施
- 不能临时改变实施方案
- 遵循所有代码规范
- 添加必要的注释说明

#### 3.3 代码清理
```
代码清理检查表：
- [ ] 删除调试代码和注释
- [ ] 清理无用的导入和变量
- [ ] 移除废弃的函数和类
- [ ] 更新过时的注释和文档
- [ ] 整理代码格式和缩进
```

### 第四步：验证测试阶段
**目标：** 确保问题真正解决，无副作用

#### 4.1 功能验证
- 重现原始问题，确认已修复
- 测试相关功能的正常运行
- 验证边界条件和异常情况
- 确认修复没有引入新问题

#### 4.2 回归测试
- 运行自动化测试套件
- 手动测试核心功能路径
- 验证性能没有劣化
- 检查内存泄漏等问题

#### 4.3 验证标准
```
验证完成标准：
- [ ] 原问题确实已解决
- [ ] 相关功能正常工作
- [ ] 无新增问题
- [ ] 性能无劣化
- [ ] 通过所有测试用例
```

### 第五步：文档更新阶段
**目标：** 完善文档，便于后续维护

#### 5.1 代码文档
- 更新函数和类的文档字符串
- 添加重要修改的注释说明
- 更新API文档（如有变化）

#### 5.2 问题记录
- 记录问题的完整解决过程
- 总结经验教训
- 更新故障处理知识库

## 质量检查点

### 每个阶段的质量门禁

#### 分析阶段质量门禁
- 问题根本原因已明确识别
- 分析结果有充分证据支撑
- 团队对问题认识达成一致

#### 设计阶段质量门禁  
- 解决方案完整可行
- 影响分析全面准确
- 设计方案已通过评审

#### 实施阶段质量门禁
- 代码严格按设计实现
- 代码质量符合规范
- 代码清理完成

#### 验证阶段质量门禁
- 问题确实已解决
- 无副作用和新问题
- 所有测试通过

## 常见问题及对策

### 1. 表面修复问题
**现象：** 只修改现象，不解决根本原因
**对策：** 强制执行根本原因分析，不允许跳过

### 2. 功能降级问题
**现象：** 为了快速修复降低功能要求
**对策：** 严格审查方案，禁止无授权的功能变更

### 3. 代码污染问题
**现象：** 不清理旧代码，导致代码库污染
**对策：** 代码清理作为必须环节，设置清理检查表

### 4. 验证不充分问题
**现象：** 未充分测试就声称修复完成
**对策：** 设置严格的验证标准和检查点

## 工具支持

### 推荐使用的工具
- **问题跟踪：** JIRA、GitHub Issues
- **代码审查：** GitHub PR、GitLab MR
- **测试工具：** pytest、unittest
- **代码质量：** pylint、black、mypy
- **文档工具：** Sphinx、MkDocs

---
**执行要求：** 所有问题修复必须严格按照此流程执行，不得跳过任何环节
**更新时间：** 2025-09-23
**适用范围：** 所有代码修改
