# æœ¬åœ°æ„å»ºAPKæŒ‡å—

## âš ï¸ é‡è¦è¯´æ˜

**Buildozer éœ€è¦åœ¨ Linux ç¯å¢ƒä¸­è¿è¡Œ**ï¼Œåœ¨ Windows ä¸Šéœ€è¦ï¼š
- **WSLï¼ˆWindows Subsystem for Linuxï¼‰** - æ¨èæ–¹æ¡ˆ
- æˆ–ä½¿ç”¨è™šæ‹Ÿæœºï¼ˆVirtualBox + Ubuntuï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆæ¨èï¼šä½¿ç”¨WSLï¼‰

### æ­¥éª¤1ï¼šå®‰è£…WSL

å¦‚æœè¿˜æ²¡æœ‰å®‰è£…WSLï¼š

```powershell
# ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡ŒPowerShell
wsl --install
```

å®‰è£…å®Œæˆåé‡å¯ç”µè„‘ã€‚

### æ­¥éª¤2ï¼šåœ¨WSLä¸­å®‰è£…ä¾èµ–

1. æ‰“å¼€WSLç»ˆç«¯ï¼ˆUbuntuï¼‰
2. å®‰è£…ä¾èµ–ï¼š

```bash
sudo apt-get update
sudo apt-get install -y python3-pip python3-dev build-essential git unzip openjdk-17-jdk
pip3 install buildozer cython
```

### æ­¥éª¤3ï¼šé…ç½®Android SDKè·¯å¾„

åœ¨WSLä¸­è®¾ç½®Android SDKè·¯å¾„ï¼š

```bash
# å°†Windowsè·¯å¾„è½¬æ¢ä¸ºWSLè·¯å¾„
# ä¾‹å¦‚ï¼šC:\Users\YourName\AppData\Local\Android\Sdk
# è½¬æ¢ä¸ºï¼š/mnt/c/Users/YourName/AppData/Local/Android/Sdk

# ä¸´æ—¶è®¾ç½®ï¼ˆå½“å‰ä¼šè¯æœ‰æ•ˆï¼‰
export ANDROIDSDK=/mnt/c/Users/YourName/AppData/Local/Android/Sdk

# æ°¸ä¹…è®¾ç½®ï¼ˆæ·»åŠ åˆ° ~/.bashrcï¼‰
echo 'export ANDROIDSDK=/mnt/c/Users/YourName/AppData/Local/Android/Sdk' >> ~/.bashrc
source ~/.bashrc
```

**æŸ¥æ‰¾Android SDKè·¯å¾„çš„æ–¹æ³•ï¼š**
1. æ‰“å¼€ Android Studio
2. File â†’ Settings â†’ Appearance & Behavior â†’ System Settings â†’ Android SDK
3. æŸ¥çœ‹ "Android SDK Location" è·¯å¾„
4. å°†Windowsè·¯å¾„è½¬æ¢ä¸ºWSLè·¯å¾„ï¼ˆC:\ â†’ /mnt/c/ï¼‰

### æ­¥éª¤4ï¼šå¤åˆ¶æ¨¡å—å¹¶æ„å»º

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /mnt/d/xianmuweijianjia/py_suanmingä¼ ç»Ÿç‰ˆ\ -\ å®‰å“ç‰ˆ/mobile_app

# å¤åˆ¶æ¨¡å—
python3 copy_modules.py

# æ„å»ºDebugç‰ˆæœ¬
buildozer android debug

# æˆ–æ„å»ºReleaseç‰ˆæœ¬
buildozer android release
```

## ğŸ“± ä½¿ç”¨ä¸€é”®æ„å»ºè„šæœ¬ï¼ˆæœ€ç®€å•ï¼‰

å¦‚æœå·²ç»å®‰è£…äº†WSLï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š

1. åŒå‡»è¿è¡Œï¼š`ä¸€é”®æ„å»ºAPK_å®Œæ•´ç‰ˆ.bat`
2. è„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹WSLå¹¶ä½¿ç”¨å®ƒæ„å»º
3. é€‰æ‹©æ„å»ºç±»å‹ï¼ˆDebugæˆ–Releaseï¼‰
4. ç­‰å¾…æ„å»ºå®Œæˆ

## ğŸ”§ æ‰‹åŠ¨é…ç½®æ­¥éª¤

### 1. æŸ¥æ‰¾Android SDKè·¯å¾„

**Windowsè·¯å¾„ç¤ºä¾‹ï¼š**
```
C:\Users\YourName\AppData\Local\Android\Sdk
```

**WSLè·¯å¾„ç¤ºä¾‹ï¼š**
```
/mnt/c/Users/YourName/AppData/Local/Android/Sdk
```

**è½¬æ¢è§„åˆ™ï¼š**
- `C:\` â†’ `/mnt/c/`
- `D:\` â†’ `/mnt/d/`
- åæ–œæ  `\` â†’ æ­£æ–œæ  `/`
- ç©ºæ ¼éœ€è¦è½¬ä¹‰æˆ–åŠ å¼•å·

### 2. è®¾ç½®ç¯å¢ƒå˜é‡

åœ¨WSLä¸­ï¼š

```bash
# è®¾ç½®Android SDKè·¯å¾„
export ANDROIDSDK=/mnt/c/Users/YourName/AppData/Local/Android/Sdk

# è®¾ç½®Javaè·¯å¾„ï¼ˆå¦‚æœéœ€è¦ï¼‰
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64

# éªŒè¯è·¯å¾„
echo $ANDROIDSDK
ls $ANDROIDSDK
```

### 3. æ¥å—Android SDKè®¸å¯

åœ¨WSLä¸­è¿è¡Œï¼š

```bash
cd $ANDROIDSDK
./cmdline-tools/latest/bin/sdkmanager --licenses
# è¾“å…¥ y æ¥å—æ‰€æœ‰è®¸å¯
```

### 4. æ„å»ºAPK

```bash
cd /mnt/d/xianmuweijianjia/py_suanmingä¼ ç»Ÿç‰ˆ\ -\ å®‰å“ç‰ˆ/mobile_app

# å¤åˆ¶æ¨¡å—
python3 copy_modules.py

# æ„å»º
buildozer android debug
```

## ğŸ“¦ æ„å»ºç»“æœ

æ„å»ºæˆåŠŸåï¼ŒAPKæ–‡ä»¶åœ¨ï¼š
```
mobile_app/bin/*.apk
```

## âš ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜1ï¼šæ‰¾ä¸åˆ°Android SDK

**è§£å†³ï¼š**
```bash
# æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®
ls $ANDROIDSDK

# å¦‚æœè·¯å¾„æœ‰ç©ºæ ¼ï¼Œä½¿ç”¨å¼•å·
export ANDROIDSDK="/mnt/c/Users/Your Name/AppData/Local/Android/Sdk"
```

### é—®é¢˜2ï¼šJavaç‰ˆæœ¬é”™è¯¯

**é”™è¯¯ä¿¡æ¯ï¼š** `UnsupportedClassVersionError: class file version 61.0`

**è§£å†³ï¼š**
```bash
# å®‰è£…Java 17
sudo apt-get install openjdk-17-jdk

# è®¾ç½®JAVA_HOME
export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64
```

### é—®é¢˜3ï¼šè®¸å¯æœªæ¥å—

**é”™è¯¯ä¿¡æ¯ï¼š** `license is not accepted`

**è§£å†³ï¼š**
```bash
cd $ANDROIDSDK
yes | ./cmdline-tools/latest/bin/sdkmanager --licenses
```

### é—®é¢˜4ï¼šbuildozeræ‰¾ä¸åˆ°

**è§£å†³ï¼š**
```bash
# å®‰è£…buildozer
pip3 install buildozer

# éªŒè¯å®‰è£…
buildozer --version
```

## ğŸ¯ æ¨èå·¥ä½œæµç¨‹

1. **é¦–æ¬¡æ„å»º**ï¼š
   - å®‰è£…WSL
   - åœ¨WSLä¸­å®‰è£…ä¾èµ–
   - é…ç½®Android SDKè·¯å¾„
   - è¿è¡Œæ„å»ºè„šæœ¬

2. **åç»­æ„å»º**ï¼š
   - ç›´æ¥è¿è¡Œ `ä¸€é”®æ„å»ºAPK_å®Œæ•´ç‰ˆ.bat`
   - æˆ–ä½¿ç”¨ `build_android.sh` è„šæœ¬

3. **æ›´æ–°ä»£ç å**ï¼š
   - è¿è¡Œ `python3 copy_modules.py` å¤åˆ¶æœ€æ–°æ¨¡å—
   - è¿è¡Œ `buildozer android debug` é‡æ–°æ„å»º

## ğŸ“ æ³¨æ„äº‹é¡¹

- **é¦–æ¬¡æ„å»ºéœ€è¦è¾ƒé•¿æ—¶é—´**ï¼ˆ10-30åˆ†é’Ÿï¼‰ï¼Œå› ä¸ºéœ€è¦ä¸‹è½½å¤§é‡ä¾èµ–
- **ç¡®ä¿ç½‘ç»œè¿æ¥æ­£å¸¸**ï¼Œbuildozeréœ€è¦ä¸‹è½½ä¾èµ–
- **ç¡®ä¿æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´**ï¼ˆè‡³å°‘2GBï¼‰
- **æ„å»ºè¿‡ç¨‹ä¸­ä¸è¦å…³é—­ç»ˆç«¯**

## âœ… éªŒè¯æ„å»º

æ„å»ºå®Œæˆåæ£€æŸ¥ï¼š

```bash
# æŸ¥çœ‹APKæ–‡ä»¶
ls -lh bin/*.apk

# æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆåº”è¯¥å¤§äº1MBï¼‰
du -h bin/*.apk
```

å¦‚æœçœ‹åˆ°APKæ–‡ä»¶ï¼Œè¯´æ˜æ„å»ºæˆåŠŸï¼

