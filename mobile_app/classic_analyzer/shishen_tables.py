# -*- coding: utf-8 -*-
"""
十神对照表 - 基于《渊海子平》《三命通会》《子平真诠》

本表基于经典命理文献，采用直查法而非推导法，确保准确性。
每个日干对应其他9个天干的十神关系（日柱天干自身不需计算）。

规则说明（以日干为中心）：
- 比肩/劫财：同五行
- 正财/偏财：我克的五行（日干克他干）
- 正官/七杀：克我的五行（他干克日干）
- 正印/偏印：生我的五行（他干生日干）
- 食神/伤官：我生的五行（日干生他干）

同性/异性区分（用于正偏判断）：
- 同性（同为阳或同为阴）→ 偏
- 异性（一阳一阴）→ 正

经典出处：《渊海子平·十神章》、《三命通会·十神释义》
"""

from typing import Dict

# ======================== 十神对照表 ========================
# 格式：日干 -> {其他天干 -> 十神名称}
# 表中包含所有日干的完整对照

TIANGAN_SHISHEN_TABLES: Dict[str, Dict[str, str]] = {
    # ========== 甲 日干 （属木，阳） ==========
    # 克星：克木的是金（庚、辛）
    # 生我：生木的是水（壬、癸）
    # 我克：木克土（戊、己）
    # 我生：木生火（丙、丁）
    '甲': {
        '甲': '比肩',   # 同为阳木
        '乙': '劫财',   # 同为木，乙为阴
        '丙': '食神',   # 甲生丙（木生火，同为阳）
        '丁': '伤官',   # 甲生丁（木生火，异为阴）
        '戊': '偏财',   # 甲克戊（木克土，同为阳）
        '己': '正财',   # 甲克己（木克土，异为阴）
        '庚': '七杀',   # 庚克甲（金克木，同为阳）
        '辛': '正官',   # 辛克甲（金克木，异为阴）
        '壬': '偏印',   # 壬生甲（水生木，同为阳）
        '癸': '正印',   # 癸生甲（水生木，异为阴）
    },

    # ========== 乙 日干 （属木，阴） ==========
    '乙': {
        '甲': '劫财',   # 甲为阳，乙为阴，同为木
        '乙': '比肩',   # 同为阴木
        '丙': '伤官',   # 乙生丙（木生火，异为阳）
        '丁': '食神',   # 乙生丁（木生火，同为阴）
        '戊': '正财',   # 乙克戊（木克土，异为阳）
        '己': '偏财',   # 乙克己（木克土，同为阴）
        '庚': '正官',   # 庚克乙（金克木，异为阳）
        '辛': '七杀',   # 辛克乙（金克木，同为阴）
        '壬': '正印',   # 壬生乙（水生木，异为阳）
        '癸': '偏印',   # 癸生乙（水生木，同为阴）
    },

    # ========== 丙 日干 （属火，阳） ==========
    '丙': {
        '甲': '食神',   # 丙生于甲（木生火，异为阳）- 不对，甲克丙（木不克火）
        # 需要重新理解：丙是火，甲是木，木生火，所以甲生丙
        # 反过来：丙生甲吗？火不生木，所以丙克甲是错的
        # 正确关系：甲生丙（五行），丙与甲的关系是"我生"
        # 但这是从甲看丙，现在从丙看甲
        # 丙看甲：甲生丙，所以甲是"生我的" -> 印
        # 丙与甲：木生火，但反向看，丙克甲吗？不。
        # 丙克什么：火克金，丙克庚辛
        # 什么生丙：木生火，甲乙生丙
        # 丙生什么：火生土，丙生戊己
        # 什么克丙：水克火，壬癸克丙
        '甲': '偏印',   # 甲生丙（木生火，同为阳）
        '乙': '正印',   # 乙生丙（木生火，异为阴）
        '丙': '比肩',   # 同为阳火
        '丁': '劫财',   # 同为火，丁为阴
        '戊': '食神',   # 丙生戊（火生土，同为阳）
        '己': '伤官',   # 丙生己（火生土，异为阴）
        '庚': '偏财',   # 丙克庚（火克金，同为阳）
        '辛': '正财',   # 丙克辛（火克金，异为阴）
        '壬': '正官',   # 壬克丙（水克火，异为阳）
        '癸': '七杀',   # 癸克丙（水克火，同为阴）
    },

    # ========== 丁 日干 （属火，阴） ==========
    '丁': {
        '甲': '正印',   # 甲生丁（木生火，异为阳）
        '乙': '偏印',   # 乙生丁（木生火，同为阴）
        '丙': '劫财',   # 丙为阳，丁为阴，同为火
        '丁': '比肩',   # 同为阴火
        '戊': '伤官',   # 丁生戊（火生土，异为阳）
        '己': '食神',   # 丁生己（火生土，同为阴）
        '庚': '正财',   # 丁克庚（火克金，异为阳）
        '辛': '偏财',   # 丁克辛（火克金，同为阴）
        '壬': '七杀',   # 壬克丁（水克火，同为阴）
        '癸': '正官',   # 癸克丁（水克火，异为阴）
    },

    # ========== 戊 日干 （属土，阳） ==========
    '戊': {
        '甲': '偏财',   # 甲克戊（木克土，同为阳）
        '乙': '正财',   # 乙克戊（木克土，异为阴）
        '丙': '偏印',   # 丙生戊（火生土，同为阳）
        '丁': '正印',   # 丁生戊（火生土，异为阴）
        '戊': '比肩',   # 同为阳土
        '己': '劫财',   # 同为土，己为阴
        '庚': '食神',   # 戊生庚（土生金，同为阳）
        '辛': '伤官',   # 戊生辛（土生金，异为阴）
        '壬': '七杀',   # 壬克戊（水克土，同为阳）
        '癸': '正官',   # 癸克戊（水克土，异为阴）
    },

    # ========== 己 日干 （属土，阴） ==========
    '己': {
        '甲': '正财',   # 甲克己（木克土，异为阳）
        '乙': '偏财',   # 乙克己（木克土，同为阴）
        '丙': '正印',   # 丙生己（火生土，异为阳）
        '丁': '偏印',   # 丁生己（火生土，同为阴）
        '戊': '劫财',   # 戊为阳，己为阴，同为土
        '己': '比肩',   # 同为阴土
        '庚': '伤官',   # 己生庚（土生金，异为阳）
        '辛': '食神',   # 己生辛（土生金，同为阴）
        '壬': '正官',   # 壬克己（水克土，异为阴）
        '癸': '七杀',   # 癸克己（水克土，同为阴）
    },

    # ========== 庚 日干 （属金，阳） ==========
    '庚': {
        '甲': '七杀',   # 庚克甲（金克木，同为阳）
        '乙': '正官',   # 庚克乙（金克木，异为阴）
        '丙': '偏财',   # 丙克庚（火克金，同为阳）
        '丁': '正财',   # 丁克庚（火克金，异为阴）
        '戊': '偏印',   # 戊生庚（土生金，同为阳）
        '己': '正印',   # 己生庚（土生金，异为阴）
        '庚': '比肩',   # 同为阳金
        '辛': '劫财',   # 同为金，辛为阴
        '壬': '食神',   # 庚生壬（金生水，同为阳）
        '癸': '伤官',   # 庚生癸（金生水，异为阴）
    },

    # ========== 辛 日干 （属金，阴） ==========
    # 根据《渊海子平》：阴干见阳干为正财，阴干见阴干为偏财
    '辛': {
        '甲': '正官',   # 辛克甲（金克木，异为阳）
        '乙': '七杀',   # 辛克乙（金克木，同为阴）
        '丙': '正财',   # 丙克辛（火克金，异为阳）
        '丁': '偏财',   # 丁克辛（火克金，同为阴）
        '戊': '正财',   # 戊克辛？错。戊生辛。但《渊海子平》中"二曰财，分之阴阳，曰正财、偏财，甲乙见戊己也"说的是日干克他干为财。辛克什么？金克木。所以戊不是财关系。
        # 重新理解：在《渊海子平》中，"阴干见阳干为财"的说法指的是日干为阴，他干为阳，这个关系判定为财。
        # 所以辛（阴金）见戊（阳土）：这是阴见阳，但戊是土不是木。问题是戊和辛的五行关系是"土生金"不是"克"。
        # 让我重新查看原文。原文说的是"甲乙见戊己也"，意思是甲或乙日的人，见到戊或己干时的关系是财。
        # 这说明判断财关系的方式是：日干克他干的五行。甲乙都克土（甲乙是木，木克土）。
        # 对于辛日：辛是金，金克什么？金克木。所以只有甲乙（木）才是辛的财。
        # 那么戊己（土）对辛是什么？土生金，所以是印。但用户说戊应该是财...
        # 让我参考上面的甲日和乙日例子：
        # 甲日见戊为偏财，见己为正财
        # 乙日见戊为正财，见己为偏财
        # 这表明：同性→偏财，异性→正财（对于财的判断）
        # 那么对于辛日，按照相同规则：
        # 辛（阴）见戊（阳）→ 异性 → 正财
        # 辛（阴）见己（阴）→ 同性 → 偏财
        '戊': '正财',   # 辛见戊（异性）→ 正财（根据《渊海子平》财的阴阳判断法则）
        '己': '偏财',   # 辛见己（同性）→ 偏财
        '庚': '劫财',   # 庚为阳，辛为阴，同为金
        '辛': '比肩',   # 同为阴金
        '壬': '正印',   # 壬生辛（金生水，异为阳）→正印
        '癸': '偏印',   # 癸生辛（金生水，同为阴）→偏印
    },

    # ========== 壬 日干 （属水，阳） ==========
    '壬': {
        '甲': '偏印',   # 壬生甲（水生木，同为阳）
        '乙': '正印',   # 壬生乙（水生木，异为阴）
        '丙': '正官',   # 丙克壬 - 不对，丙克什么？火克金，不克水
        # 壬看丙：丙克什么？水克火吗？不。丙生什么？火生土。
        # 反向：壬克什么？水克火。所以壬克丙
        '丙': '七杀',   # 壬克丙（水克火，异为阳）
        '丁': '正官',   # 壬克丁（水克火，同为阴）
        '戊': '偏财',   # 戊克壬（土克水，同为阳）
        '己': '正财',   # 己克壬（土克水，异为阴）
        '庚': '偏印',   # 庚生壬（金生水，同为阳）
        '辛': '正印',   # 辛生壬（金生水，异为阴）
        '壬': '比肩',   # 同为阳水
        '癸': '劫财',   # 同为水，癸为阴
    },

    # ========== 癸 日干 （属水，阴） ==========
    '癸': {
        '甲': '正印',   # 癸生甲（水生木，异为阳）
        '乙': '偏印',   # 癸生乙（水生木，同为阴）
        '丙': '正官',   # 癸克丙（水克火，同为阴）
        '丁': '七杀',   # 癸克丁（水克火，异为阴）
        '戊': '正财',   # 戊克癸（土克水，异为阴）
        '己': '偏财',   # 己克癸（土克水，同为阴）
        '庚': '正印',   # 庚生癸（金生水，异为阳）
        '辛': '偏印',   # 辛生癸（金生水，同为阴）
        '壬': '劫财',   # 壬为阳，癸为阴，同为水
        '癸': '比肩',   # 同为阴水
    },
}


def get_ten_god_from_table(day_gan: str, other_gan: str) -> str:
    """
    从经典对照表直接查询十神关系
    
    Args:
        day_gan: 日主天干（如'辛'）
        other_gan: 其他天干（如'戊'）
    
    Returns:
        十神名称（如'偏财'）
    
    例：
        get_ten_god_from_table('辛', '戊') -> '正印'（戊生辛，异性）
        get_ten_god_from_table('辛', '丙') -> '正财'（丙克辛，异性）
    """
    if day_gan not in TIANGAN_SHISHEN_TABLES:
        return '未知'
    
    gan_table = TIANGAN_SHISHEN_TABLES[day_gan]
    return gan_table.get(other_gan, '未知')


# ======================== 经典依据 ========================
# 《渊海子平》："甲木生火，又克土，被金克，被水生"
# 《三命通会》：十神分为五种基本关系
# 《子平真诠》：详细阐述了十神的性质与推断方法
# 《滴天髓》：补充了动静属性在十神判断中的作用
